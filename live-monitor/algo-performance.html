<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Algorithm Performance: Learned vs Original | Find Toronto Events</title>
    <script defer src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --bg-dark: #0a0a1a;
            --bg-card: #12122a;
            --bg-card-hover: #1a1a3a;
            --border: #2a2a4a;
            --text: #e0e0f0;
            --text-dim: #8888aa;
            --accent: #6366f1;
            --green: #22c55e;
            --green-dim: rgba(34, 197, 94, 0.15);
            --red: #ef4444;
            --red-dim: rgba(239, 68, 68, 0.15);
            --yellow: #eab308;
            --yellow-dim: rgba(234, 179, 8, 0.15);
            --blue: #3b82f6;
            --orange: #f97316;
            --purple: #a855f7;
            --radius: 12px;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: var(--bg-dark); color: var(--text); min-height: 100vh; line-height: 1.6; }
        a { color: var(--accent); text-decoration: none; }
        a:hover { text-decoration: underline; }

        .header { background: linear-gradient(135deg, #12122a 0%, #1e1e3f 100%); border-bottom: 1px solid var(--border); padding: 1.5rem 2rem; text-align: center; }
        .header h1 { font-size: 2rem; background: linear-gradient(135deg, var(--accent), #a78bfa, var(--blue)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; margin-bottom: 0.3rem; }
        .header p { color: var(--text-dim); font-size: 0.95rem; }

        .container { max-width: 1300px; margin: 0 auto; padding: 1.5rem; }

        /* ── Cards ── */
        .kpi-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1rem; margin-bottom: 1.5rem; }
        .kpi-card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); padding: 1.2rem; }
        .kpi-card h3 { font-size: 12px; color: var(--text-dim); text-transform: uppercase; letter-spacing: 0.5px; margin-bottom: 0.5rem; }
        .kpi-card .value { font-size: 2rem; font-weight: 700; }
        .kpi-card .sub { font-size: 12px; color: var(--text-dim); margin-top: 4px; }
        .kpi-card .tag { display: inline-block; padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; margin-left: 8px; }
        .tag-learned { background: rgba(99, 102, 241, 0.15); color: #818cf8; }
        .tag-original { background: rgba(234, 179, 8, 0.15); color: #facc15; }
        .pos { color: var(--green); }
        .neg { color: var(--red); }

        /* ── Comparison boxes ── */
        .compare-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem; }
        .compare-box { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); padding: 1.5rem; }
        .compare-box.learned-box { border-left: 3px solid var(--accent); }
        .compare-box.original-box { border-left: 3px solid var(--yellow); }
        .compare-box h2 { font-size: 1.1rem; margin-bottom: 1rem; }
        .compare-box .metric-row { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid rgba(42, 42, 74, 0.5); font-size: 14px; }
        .compare-box .metric-row:last-child { border-bottom: none; }
        .compare-box .metric-label { color: var(--text-dim); }
        .compare-box .metric-value { font-weight: 600; }

        /* ── Table ── */
        .section-title { font-size: 1.1rem; color: var(--text-dim); margin: 1.5rem 0 1rem; padding-bottom: 0.5rem; border-bottom: 1px solid var(--border); }
        .table-wrap { overflow-x: auto; border: 1px solid var(--border); border-radius: var(--radius); margin-bottom: 1.5rem; }
        table { width: 100%; border-collapse: collapse; font-size: 13px; }
        thead th { background: var(--bg-card); color: var(--text-dim); text-transform: uppercase; font-size: 11px; letter-spacing: 0.5px; padding: 10px 12px; text-align: left; white-space: nowrap; position: sticky; top: 0; }
        tbody tr { border-top: 1px solid var(--border); }
        tbody tr:hover { background: var(--bg-card-hover); }
        td { padding: 8px 12px; white-space: nowrap; }
        .badge-win { background: var(--green-dim); color: var(--green); padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; }
        .badge-loss { background: var(--red-dim); color: var(--red); padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; }

        /* ── Chart ── */
        .chart-box { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius); padding: 1.5rem; margin-bottom: 1.5rem; }
        .chart-box h3 { font-size: 14px; color: var(--text-dim); margin-bottom: 1rem; }
        canvas { max-height: 350px; }

        /* ── Tabs ── */
        .tabs { display: flex; gap: 0; margin-bottom: 1.5rem; border: 1px solid var(--border); border-radius: 8px; overflow: hidden; }
        .tab-btn { flex: 1; background: var(--bg-dark); color: var(--text-dim); border: none; padding: 10px 16px; font-size: 13px; cursor: pointer; text-align: center; transition: all 0.15s; }
        .tab-btn:not(:last-child) { border-right: 1px solid var(--border); }
        .tab-btn.active { background: var(--accent); color: #fff; font-weight: 600; }
        .tab-btn:hover:not(.active) { background: var(--bg-card-hover); color: var(--text); }

        .loading { text-align: center; padding: 3rem; color: var(--text-dim); }
        .error-box { background: var(--red-dim); border: 1px solid rgba(239, 68, 68, 0.3); border-radius: 8px; padding: 1rem; color: #fca5a5; text-align: center; margin-bottom: 1rem; }
        .backfill-bar { background: var(--yellow-dim); border: 1px solid rgba(234, 179, 8, 0.3); border-radius: 8px; padding: 0.6rem 1rem; font-size: 13px; color: #facc15; margin-bottom: 1rem; display: flex; justify-content: space-between; align-items: center; }
        .backfill-bar button { background: var(--yellow); color: #000; border: none; padding: 4px 12px; border-radius: 6px; font-size: 12px; cursor: pointer; font-weight: 600; }
        .footer { text-align: center; padding: 2rem; color: var(--text-dim); font-size: 0.8rem; border-top: 1px solid var(--border); margin-top: 2rem; }

        @media (max-width: 768px) {
            .compare-grid { grid-template-columns: 1fr; }
            .kpi-row { grid-template-columns: 1fr 1fr; }
            .header h1 { font-size: 1.5rem; }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>Self-Learning vs Original</h1>
        <p>Performance comparison: adaptive algorithm parameters vs hardcoded defaults</p>
    </div>

    <div class="container">
        <!-- #1 PICK Banner — data-verified designation -->
        <div id="gold-banner" style="background:linear-gradient(135deg,rgba(255,215,0,0.08),rgba(245,158,11,0.08));border:2px solid rgba(255,215,0,0.5);border-radius:var(--radius);padding:1.2rem 1.5rem;margin-bottom:1.2rem;position:relative;overflow:hidden;animation:gold-border-pulse 3s ease-in-out infinite;">
            <div style="display:flex;align-items:center;gap:12px;margin-bottom:0.6rem;flex-wrap:wrap;">
                <span style="background:linear-gradient(135deg,#ffd700,#f59e0b);color:#0a0e1a;padding:4px 12px;border-radius:6px;font-weight:800;font-size:13px;letter-spacing:1px;">#1 PICK</span>
                <span style="background:rgba(34,211,238,0.15);color:#22d3ee;padding:3px 10px;border-radius:6px;font-weight:700;font-size:11px;border:1px solid rgba(34,211,238,0.3);">BEST CRYPTO</span>
                <span style="color:#ffd700;font-weight:700;font-size:1.1rem;">Our Best Performing System</span>
                <span id="gold-timestamp" style="color:var(--text-dim);font-size:11px;margin-left:auto;"></span>
            </div>
            <p style="color:#e0e0f0;font-size:0.85rem;line-height:1.6;margin-bottom:0.5rem;">
                After auditing <strong style="color:#ffd700;">every investment page</strong> across the platform, this is the <strong style="color:#ffd700;">only system with positive forward-facing returns</strong>. No backtesting. No simulations. Real trades, real prices, real P&amp;L.
            </p>
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:0.8rem;margin-top:0.8rem;">
                <div style="background:rgba(0,0,0,0.2);border-radius:8px;padding:0.6rem 0.8rem;border:1px solid rgba(255,215,0,0.15);">
                    <div style="font-size:11px;color:var(--text-dim);text-transform:uppercase;letter-spacing:0.5px;">Win Rate</div>
                    <div id="gold-wr" style="font-size:1.4rem;font-weight:700;color:#22c55e;">--</div>
                </div>
                <div style="background:rgba(0,0,0,0.2);border-radius:8px;padding:0.6rem 0.8rem;border:1px solid rgba(255,215,0,0.15);">
                    <div style="font-size:11px;color:var(--text-dim);text-transform:uppercase;letter-spacing:0.5px;">Cumulative P&amp;L</div>
                    <div id="gold-pnl" style="font-size:1.4rem;font-weight:700;color:#22c55e;">--</div>
                </div>
                <div style="background:rgba(0,0,0,0.2);border-radius:8px;padding:0.6rem 0.8rem;border:1px solid rgba(255,215,0,0.15);">
                    <div style="font-size:11px;color:var(--text-dim);text-transform:uppercase;letter-spacing:0.5px;">Top Algorithm</div>
                    <div id="gold-top-algo" style="font-size:1rem;font-weight:700;color:#ffd700;">--</div>
                </div>
                <div style="background:rgba(0,0,0,0.2);border-radius:8px;padding:0.6rem 0.8rem;border:1px solid rgba(255,215,0,0.15);">
                    <div style="font-size:11px;color:var(--text-dim);text-transform:uppercase;letter-spacing:0.5px;">Verified Against</div>
                    <div style="font-size:0.85rem;font-weight:600;color:#e0e0f0;">CoinGecko, Yahoo Finance</div>
                </div>
            </div>
            <p style="color:var(--text-dim);font-size:0.75rem;margin-top:0.7rem;line-height:1.5;">
                <strong style="color:#f59e0b;">Why #1?</strong> Every other system on the platform is either net-negative, has zero closed trades, or is research-only (Smart Money). This page shows the only algorithms that learned, adapted, and delivered real profit across <span id="gold-closed-count">--</span> closed trades. Best asset class: Crypto (<span id="gold-crypto-pnl">--</span> P&amp;L, <span id="gold-crypto-wr">--</span> WR). Stock positions still being tracked (first closures expected ~Feb 24).
            </p>
        </div>
        <style>
            @keyframes gold-border-pulse {
                0%, 100% { border-color: rgba(255,215,0,0.5); box-shadow: 0 0 15px rgba(255,215,0,0.1); }
                50% { border-color: rgba(255,215,0,0.8); box-shadow: 0 0 30px rgba(255,215,0,0.2), 0 0 60px rgba(255,215,0,0.05); }
            }
        </style>

        <div style="background:linear-gradient(135deg,rgba(99,102,241,0.06),rgba(168,85,247,0.06));border:1px solid rgba(99,102,241,0.2);border-radius:var(--radius);padding:0.7rem 1.2rem;margin-bottom:1rem;font-size:0.8rem;color:var(--text-dim);">
            Tracking <strong style="color:var(--text)">19 algorithms</strong> across <strong style="color:var(--text)">36 assets</strong> (14 crypto, 10 forex, 12 stocks). Stock universe: AAPL, MSFT, GOOGL, AMZN, NVDA, META, JPM, BAC, WMT, XOM, NFLX, JNJ. Signals generated every 30 minutes during market hours.
        </div>

        <div id="backfill-bar" class="backfill-bar" style="display:none;">
            <span><strong id="untagged-count">0</strong> historical signals need param tagging</span>
            <button onclick="runBackfill()">Run Backfill</button>
        </div>

        <div class="tabs">
            <button class="tab-btn active" onclick="switchTab('overview')">Overview</button>
            <button class="tab-btn" onclick="switchTab('algorithms')">By Algorithm</button>
            <button class="tab-btn" onclick="switchTab('params')">Param Comparison</button>
            <button class="tab-btn" onclick="switchTab('trades')">Recent Trades</button>
            <button class="tab-btn" onclick="switchTab('analysis')" style="color:#f59e0b;">System Analysis</button>
            <button class="tab-btn" onclick="switchTab('research')" style="color:#a855f7;">Research &amp; Future</button>
        </div>

        <!-- Overview Tab -->
        <div id="tab-overview">
            <div id="algo-empty-note" style="display:none;background:rgba(99,102,241,0.06);border:1px solid rgba(99,102,241,0.2);border-radius:var(--radius);padding:0.75rem 1.2rem;margin-bottom:1rem;font-size:0.8rem;color:var(--text-dim);line-height:1.5;">
                Performance comparison requires trade data from both learned and original parameter sets. Stats will populate as the system accumulates trades.
            </div>
            <div class="kpi-row" id="kpi-row"></div>
            <div class="compare-grid" id="compare-grid"></div>
            <div class="chart-box">
                <h3>Win Rate: Self-Learning vs Original by Asset Class</h3>
                <canvas id="chart-wr"></canvas>
            </div>
        </div>

        <!-- Algorithms Tab -->
        <div id="tab-algorithms" style="display:none;">
            <div class="section-title">Per-Algorithm Performance</div>
            <div class="table-wrap">
                <table>
                    <thead>
                        <tr>
                            <th>Algorithm</th>
                            <th>Source</th>
                            <th>Trades</th>
                            <th>Win Rate</th>
                            <th>Avg PnL</th>
                            <th>Total PnL</th>
                            <th>Avg TP</th>
                            <th>Avg SL</th>
                            <th>Avg Hold</th>
                        </tr>
                    </thead>
                    <tbody id="algo-tbody"></tbody>
                </table>
            </div>
            <div class="chart-box">
                <h3>Avg PnL per Algorithm: Learned vs Original</h3>
                <canvas id="chart-algo-pnl"></canvas>
            </div>
        </div>

        <!-- Params Tab -->
        <div id="tab-params" style="display:none;">
            <div class="section-title">Current Parameters: Original Defaults vs Self-Learned</div>
            <div class="table-wrap">
                <table>
                    <thead>
                        <tr>
                            <th>Algorithm</th>
                            <th>Asset</th>
                            <th>Orig TP%</th>
                            <th>Learned TP%</th>
                            <th>Orig SL%</th>
                            <th>Learned SL%</th>
                            <th>Orig Hold</th>
                            <th>Learned Hold</th>
                            <th>Orig WR</th>
                            <th>Learned WR</th>
                            <th>Verdict</th>
                        </tr>
                    </thead>
                    <tbody id="params-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- Trades Tab -->
        <div id="tab-trades" style="display:none;">
            <div class="section-title">Recent Closed Trades (with param source)</div>
            <div class="table-wrap">
                <table>
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Symbol</th>
                            <th>Algorithm</th>
                            <th>Dir</th>
                            <th>Source</th>
                            <th>Entry</th>
                            <th>Exit</th>
                            <th>PnL%</th>
                            <th>Reason</th>
                            <th>TP/SL/Hold Used</th>
                            <th>TP/SL/Hold Original</th>
                        </tr>
                    </thead>
                    <tbody id="trades-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════ -->
        <!-- TAB 5: SYSTEM ANALYSIS -->
        <!-- ═══════════════════════════════════════════ -->
        <div id="tab-analysis" style="display:none;">
            <div class="section-title" style="color:#f59e0b;">System Analysis <span style="display:inline-block;padding:2px 8px;border-radius:4px;font-size:11px;font-weight:600;background:rgba(245,158,11,0.15);color:#f59e0b;border:1px solid rgba(245,158,11,0.3);">DIAGNOSIS</span></div>

            <!-- Status / Strengths / Flaws grid -->
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1rem;margin-bottom:1.5rem;">
                <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;">
                    <h4 style="font-size:0.85rem;color:var(--yellow);margin-bottom:0.5rem;">Current Performance</h4>
                    <div style="font-size:12px;color:var(--text-dim);line-height:1.7;">
                        &bull; <strong>12 total closed trades:</strong> 7 wins, 5 losses = 58.33% WR<br>
                        &bull; <strong>Profit factor:</strong> 2.61 (gross wins / gross losses)<br>
                        &bull; <strong>Average return:</strong> +0.79% per trade<br>
                        &bull; <strong>Average hold:</strong> 8.21 hours<br>
                        &bull; <strong>Total PnL:</strong> +$45.58 on $10K portfolio<br>
                        &bull; <strong>Peak value:</strong> $10,022.40, drawdown: 0.42%
                    </div>
                </div>
                <div style="background:var(--bg-card);border:1px solid rgba(34,197,94,0.3);border-radius:var(--radius);padding:1.2rem;">
                    <h4 style="font-size:0.85rem;color:var(--green);margin-bottom:0.5rem;">Strengths</h4>
                    <div style="font-size:12px;color:var(--text-dim);line-height:1.7;">
                        &bull; <strong>PROOF that ML learning improves results</strong> &mdash; learned params outperform defaults<br>
                        &bull; Per-asset-class breakdown identifies strong spots per asset<br>
                        &bull; Transparent parameter comparison table<br>
                        &bull; Real-time trade logging with entry/exit prices<br>
                        &bull; Automated grid search optimization pipeline<br>
                        &bull; Regime detection gates protect against adverse market conditions<br>
                        &bull; <strong>Walk-forward validation:</strong> <span style="color:#22c55e;">DEPLOYED</span><br>
                        &bull; <strong>Concept drift detection:</strong> <span style="color:#22c55e;">DEPLOYED</span><br>
                        &bull; <strong>Multi-timeframe regime:</strong> <span style="color:#22c55e;">DEPLOYED</span><br>
                        &bull; <strong>Online incremental learning:</strong> <span style="color:#22c55e;">DEPLOYED</span><br>
                        &bull; <strong>Cross-asset intelligence:</strong> <span style="color:#22c55e;">DEPLOYED</span>
                    </div>
                </div>
                <div style="background:var(--bg-card);border:1px solid rgba(239,68,68,0.3);border-radius:var(--radius);padding:1.2rem;">
                    <h4 style="font-size:0.85rem;color:var(--red);margin-bottom:0.5rem;">Flaws &amp; Limitations</h4>
                    <div style="font-size:12px;color:var(--text-dim);line-height:1.7;">
                        &bull; <strong>Only 12 closed trades</strong> &mdash; statistically insignificant (need 100+)<br>
                        &bull; <strong>Forex is broken:</strong> 0% WR with wrong algorithms deployed<br>
                        &bull; <strong>Walk-forward validation:</strong> <span style="color:#22c55e;">DEPLOYED</span> (<code>walk_forward_validator.py</code>)<br>
                        &bull; <strong>Grid search only optimizes TP/SL/Hold</strong> &mdash; doesn't optimize entry signals<br>
                        &bull; <strong>No ensemble weighting</strong> &mdash; all algorithms treated equally<br>
                        &bull; <strong>No EGARCH volatility-adjusted sizing</strong> &mdash; uses fixed 5% per position<br>
                        &bull; <strong>Challenger Bot 0% WR</strong> &mdash; missing regime gating (fix in progress)
                    </div>
                </div>
            </div>

            <!-- Top Algorithms -->
            <h4 style="font-size:0.9rem;margin-bottom:0.75rem;color:var(--yellow);">Top Algorithms (Live Forward Performance)</h4>
            <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;margin-bottom:1.5rem;">
                <table style="width:100%;font-size:12px;border-collapse:collapse;">
                    <thead><tr style="border-bottom:1px solid var(--border);">
                        <th style="text-align:left;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">Algorithm</th>
                        <th style="text-align:center;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">Win Rate</th>
                        <th style="text-align:center;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">Record</th>
                        <th style="text-align:right;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">PnL</th>
                        <th style="text-align:left;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">Notes</th>
                    </tr></thead>
                    <tbody style="color:var(--text);">
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;"><strong>Ichimoku Cloud</strong></td><td style="padding:6px 8px;text-align:center;color:var(--green);">80%</td><td style="padding:6px 8px;text-align:center;">4W / 1L</td><td style="padding:6px 8px;text-align:right;color:var(--green);">+$44.97</td><td style="padding:6px 8px;color:var(--text-dim);">BEST performer overall</td></tr>
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;"><strong>StochRSI Crossover</strong></td><td style="padding:6px 8px;text-align:center;color:var(--green);">100%</td><td style="padding:6px 8px;text-align:center;">3W / 0L</td><td style="padding:6px 8px;text-align:right;color:var(--green);">+$16.39</td><td style="padding:6px 8px;color:var(--text-dim);">Perfect record (small sample)</td></tr>
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;">RSI Reversal</td><td style="padding:6px 8px;text-align:center;color:var(--red);">0%</td><td style="padding:6px 8px;text-align:center;">0W / 1L</td><td style="padding:6px 8px;text-align:right;color:var(--red);">-$0.17</td><td style="padding:6px 8px;color:var(--text-dim);">Single trade loss</td></tr>
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;">Consensus</td><td style="padding:6px 8px;text-align:center;color:var(--red);">0%</td><td style="padding:6px 8px;text-align:center;">0W / 2L</td><td style="padding:6px 8px;text-align:right;color:var(--red);">-$3.28</td><td style="padding:6px 8px;color:var(--text-dim);">Regime-gated now</td></tr>
                        <tr><td style="padding:6px 8px;">Challenger Bot</td><td style="padding:6px 8px;text-align:center;color:var(--red);">0%</td><td style="padding:6px 8px;text-align:center;">0W / 2L</td><td style="padding:6px 8px;text-align:right;color:var(--red);">-$12.33</td><td style="padding:6px 8px;color:var(--text-dim);">Fix incoming (regime gate)</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- ML Parameter Learning -->
            <h4 style="font-size:0.9rem;margin-bottom:0.75rem;color:var(--yellow);">ML Parameter Learning (Grid Search Results)</h4>
            <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;margin-bottom:1.5rem;">
                <table style="width:100%;font-size:12px;border-collapse:collapse;">
                    <thead><tr style="border-bottom:1px solid var(--border);">
                        <th style="text-align:left;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">Algorithm</th>
                        <th style="text-align:left;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">Parameter</th>
                        <th style="text-align:center;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">Original</th>
                        <th style="text-align:center;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">Learned</th>
                        <th style="text-align:center;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">Change</th>
                    </tr></thead>
                    <tbody style="color:var(--text);">
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;" rowspan="3"><strong>Ichimoku Cloud</strong></td><td style="padding:6px 8px;">Take Profit</td><td style="padding:6px 8px;text-align:center;">5%</td><td style="padding:6px 8px;text-align:center;color:var(--accent);">8.5%</td><td style="padding:6px 8px;text-align:center;color:var(--green);">+70%</td></tr>
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;">Stop Loss</td><td style="padding:6px 8px;text-align:center;">2.5%</td><td style="padding:6px 8px;text-align:center;color:var(--accent);">5%</td><td style="padding:6px 8px;text-align:center;color:var(--green);">+100%</td></tr>
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;">Max Hold</td><td style="padding:6px 8px;text-align:center;">24h</td><td style="padding:6px 8px;text-align:center;color:var(--accent);">12h</td><td style="padding:6px 8px;text-align:center;color:var(--yellow);">-50%</td></tr>
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;" rowspan="2"><strong>StochRSI Crossover</strong></td><td style="padding:6px 8px;">Take Profit</td><td style="padding:6px 8px;text-align:center;">5%</td><td style="padding:6px 8px;text-align:center;color:var(--accent);">7.75%</td><td style="padding:6px 8px;text-align:center;color:var(--green);">+55%</td></tr>
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;">Stop Loss</td><td style="padding:6px 8px;text-align:center;">2.5%</td><td style="padding:6px 8px;text-align:center;color:var(--accent);">4%</td><td style="padding:6px 8px;text-align:center;color:var(--green);">+60%</td></tr>
                        <tr><td style="padding:6px 8px;"><strong>Consensus</strong></td><td style="padding:6px 8px;">Max Hold</td><td style="padding:6px 8px;text-align:center;">24h</td><td style="padding:6px 8px;text-align:center;color:var(--accent);">12h</td><td style="padding:6px 8px;text-align:center;color:var(--yellow);">-50%</td></tr>
                    </tbody>
                </table>
                <div style="font-size:11px;color:var(--text-dim);margin-top:0.75rem;line-height:1.5;">
                    &bull; 2,491 learned signals generated vs 500 original<br>
                    &bull; Grid search activates after 20 closed trades per algorithm<br>
                    &bull; Exhaustive search over TP (2-15%), SL (1-8%), Hold (2-48h) combinations
                </div>
            </div>

            <!-- Architecture -->
            <h4 style="font-size:0.9rem;margin-bottom:0.75rem;color:var(--yellow);">Architecture</h4>
            <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;margin-bottom:1.5rem;">
                <div style="font-size:12px;color:var(--text-dim);line-height:1.8;">
                    <strong style="color:var(--text);">Signal Pipeline:</strong><br>
                    <code style="background:rgba(99,102,241,0.1);padding:2px 6px;border-radius:4px;font-size:11px;color:var(--accent);">live_signals.php (20 algos)</code>
                    &rarr; <code style="background:rgba(99,102,241,0.1);padding:2px 6px;border-radius:4px;font-size:11px;color:var(--accent);">signals table</code>
                    &rarr; <code style="background:rgba(99,102,241,0.1);padding:2px 6px;border-radius:4px;font-size:11px;color:var(--accent);">live_trade.php</code>
                    &rarr; <code style="background:rgba(99,102,241,0.1);padding:2px 6px;border-radius:4px;font-size:11px;color:var(--accent);">trades table</code><br><br>
                    <strong style="color:var(--text);">Performance Tracking:</strong><br>
                    &bull; <code style="font-size:11px;">algo_performance.php</code> reads from trades, calculates L vs O metrics<br>
                    &bull; Actions: summary, by_algorithm, by_asset, learned_params, trades<br><br>
                    <strong style="color:var(--text);">Grid Search Optimization:</strong><br>
                    &bull; Triggers after 20+ closed trades per algorithm<br>
                    &bull; Optimizes TP, SL, and Hold per algo per asset class<br>
                    &bull; Selects parameters that maximize Sharpe ratio on historical trades<br><br>
                    <strong style="color:var(--text);">Regime Detection:</strong><br>
                    &bull; HMM (3 states: bull, bear, sideways) gates 19/20 algorithms<br>
                    &bull; Prevents entries during adverse market conditions<br>
                    &bull; <code style="font-size:11px;">multi_timeframe_regime.py</code> &mdash; 4h/daily/weekly regime analysis <span style="color:#22c55e;">DEPLOYED</span><br><br>
                    <strong style="color:var(--text);">ML Infrastructure (Feb 2026):</strong><br>
                    &bull; <code style="font-size:11px;">walk_forward_validator.py</code> &mdash; rolling window validation, overfitting protection <span style="color:#22c55e;">DEPLOYED</span><br>
                    &bull; <code style="font-size:11px;">concept_drift_detector.py</code> &mdash; daily drift monitoring, distribution shift alerts <span style="color:#22c55e;">DEPLOYED</span><br>
                    &bull; <code style="font-size:11px;">online_meta_learner.py</code> &mdash; incremental XGBoost updates without full retraining <span style="color:#22c55e;">DEPLOYED</span><br>
                    &bull; <code style="font-size:11px;">cross_asset_ml_intelligence.py</code> &mdash; cross-asset correlation and signal intelligence <span style="color:#22c55e;">DEPLOYED</span>
                </div>
            </div>

            <!-- Production Readiness -->
            <h4 style="font-size:0.9rem;margin-bottom:0.75rem;color:var(--yellow);">Production Readiness</h4>
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1rem;margin-bottom:1.5rem;">
                <div style="background:var(--bg-card);border:1px solid rgba(34,197,94,0.3);border-radius:var(--radius);padding:1.2rem;">
                    <h4 style="font-size:0.85rem;color:var(--green);margin-bottom:0.5rem;">Paper Trading: YES</h4>
                    <div style="font-size:12px;color:var(--text-dim);line-height:1.7;">
                        System is running and learning. Grid search pipeline operational. Regime gates active. Trade logging complete. Parameters adapting.
                    </div>
                </div>
                <div style="background:var(--bg-card);border:1px solid rgba(239,68,68,0.3);border-radius:var(--radius);padding:1.2rem;">
                    <h4 style="font-size:0.85rem;color:var(--red);margin-bottom:0.5rem;">Real Money: NO</h4>
                    <div style="font-size:12px;color:var(--text-dim);line-height:1.7;">
                        Only 12 trades &mdash; need 100+ for statistical significance. Walk-forward validation <span style="color:#22c55e;">DEPLOYED</span>. Forex broken. Challenger Bot needs regime gating.
                    </div>
                </div>
            </div>

            <!-- Milestones -->
            <h4 style="font-size:0.9rem;margin-bottom:0.75rem;color:var(--yellow);">Milestones to Real Money</h4>
            <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;margin-bottom:1rem;">
                <div style="font-size:12px;color:var(--text-dim);line-height:1.8;">
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;">
                        <span style="display:inline-block;width:20px;height:20px;border-radius:50%;background:rgba(234,179,8,0.15);color:#eab308;text-align:center;line-height:20px;font-size:10px;font-weight:700;">1</span>
                        <span><strong style="color:var(--text);">20 closed trades per algorithm</strong> &rarr; grid search triggers for that algo</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;">
                        <span style="display:inline-block;width:20px;height:20px;border-radius:50%;background:rgba(234,179,8,0.15);color:#eab308;text-align:center;line-height:20px;font-size:10px;font-weight:700;">2</span>
                        <span><strong style="color:var(--text);">50 total trades</strong> &rarr; basic walk-forward validation possible</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;">
                        <span style="display:inline-block;width:20px;height:20px;border-radius:50%;background:rgba(234,179,8,0.15);color:#eab308;text-align:center;line-height:20px;font-size:10px;font-weight:700;">3</span>
                        <span><strong style="color:var(--text);">100 total trades</strong> &rarr; statistically meaningful win rate per algorithm</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;">
                        <span style="display:inline-block;width:20px;height:20px;border-radius:50%;background:rgba(239,68,68,0.15);color:#ef4444;text-align:center;line-height:20px;font-size:10px;font-weight:700;">4</span>
                        <span><strong style="color:var(--text);">Fix forex</strong> &rarr; deploy Trend Following + Mean Reversion (not Consensus/RSI)</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;">
                        <span style="display:inline-block;width:20px;height:20px;border-radius:50%;background:rgba(239,68,68,0.15);color:#ef4444;text-align:center;line-height:20px;font-size:10px;font-weight:700;">5</span>
                        <span><strong style="color:var(--text);">Fix Challenger Bot</strong> &rarr; add regime gating</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:4px;">
                        <span style="display:inline-block;width:20px;height:20px;border-radius:50%;background:rgba(168,85,247,0.15);color:#a855f7;text-align:center;line-height:20px;font-size:10px;font-weight:700;">6</span>
                        <span><strong style="color:var(--text);">Add EGARCH position sizing</strong> &rarr; volatility-adjusted instead of fixed 5%</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;">
                        <span style="display:inline-block;width:20px;height:20px;border-radius:50%;background:rgba(168,85,247,0.15);color:#a855f7;text-align:center;line-height:20px;font-size:10px;font-weight:700;">7</span>
                        <span><strong style="color:var(--text);">Add ensemble weighting</strong> &rarr; Sharpe-weighted algorithm combination</span>
                    </div>
                </div>
            </div>

            <!-- Target Benchmarks -->
            <h4 style="font-size:0.9rem;margin-bottom:0.75rem;color:var(--yellow);">Target Benchmarks</h4>
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:0.75rem;margin-bottom:1rem;">
                <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:8px;padding:0.8rem;text-align:center;">
                    <div style="font-size:11px;color:var(--text-dim);text-transform:uppercase;">Win Rate</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--green);">55-65%</div>
                    <div style="font-size:10px;color:var(--text-dim);">Current: 58.33%</div>
                </div>
                <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:8px;padding:0.8rem;text-align:center;">
                    <div style="font-size:11px;color:var(--text-dim);text-transform:uppercase;">Profit Factor</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--green);">1.5-3.0</div>
                    <div style="font-size:10px;color:var(--text-dim);">Current: 2.61</div>
                </div>
                <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:8px;padding:0.8rem;text-align:center;">
                    <div style="font-size:11px;color:var(--text-dim);text-transform:uppercase;">Sharpe Ratio</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--yellow);">2.0-6.0</div>
                    <div style="font-size:10px;color:var(--text-dim);">TBD (need 50+ trades)</div>
                </div>
                <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:8px;padding:0.8rem;text-align:center;">
                    <div style="font-size:11px;color:var(--text-dim);text-transform:uppercase;">Max Drawdown</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--green);">&lt;20%</div>
                    <div style="font-size:10px;color:var(--text-dim);">Current: 0.42%</div>
                </div>
                <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:8px;padding:0.8rem;text-align:center;">
                    <div style="font-size:11px;color:var(--text-dim);text-transform:uppercase;">Min Trades</div>
                    <div style="font-size:1.3rem;font-weight:700;color:var(--red);">100+</div>
                    <div style="font-size:10px;color:var(--text-dim);">Current: 12</div>
                </div>
            </div>
        </div>

        <!-- ═══════════════════════════════════════════ -->
        <!-- TAB 6: RESEARCH & FUTURE -->
        <!-- ═══════════════════════════════════════════ -->
        <div id="tab-research" style="display:none;">
            <div class="section-title" style="color:#a855f7;">Research &amp; Future <span style="display:inline-block;padding:2px 8px;border-radius:4px;font-size:11px;font-weight:600;background:rgba(168,85,247,0.15);color:#a855f7;border:1px solid rgba(168,85,247,0.3);">ACADEMIC FOUNDATIONS</span></div>
            <p style="font-size:0.8rem;color:var(--text-dim);margin-bottom:1rem;">Based on academic research in systematic quant trading, machine learning for finance, and portfolio optimization. This system stands on the shoulders of decades of research.</p>

            <!-- Methodology -->
            <h4 style="font-size:0.9rem;margin-bottom:0.75rem;color:#a855f7;">Methodology</h4>
            <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;margin-bottom:1.5rem;">
                <div style="font-size:12px;color:var(--text-dim);line-height:1.8;">
                    &bull; <strong style="color:var(--text);">Grid Search Parameter Optimization:</strong> Exhaustive search over TP (2-15%), SL (1-8%), Hold (2-48h) combinations<br>
                    &bull; <strong style="color:var(--text);">Objective Function:</strong> Selects parameters that maximize Sharpe ratio on historical trades<br>
                    &bull; <strong style="color:var(--text);">Regime-Aware:</strong> Different optimal parameters per market regime (bull/bear/sideways)<br>
                    &bull; <strong style="color:var(--text);">Inspiration:</strong> Systematic quant trading (Narang 2013), machine learning for trading (de Prado 2018)
                </div>
            </div>

            <!-- Academic Research -->
            <h4 style="font-size:0.9rem;margin-bottom:0.75rem;color:#a855f7;">Academic Research Foundations</h4>
            <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(320px,1fr));gap:1rem;margin-bottom:1.5rem;">
                <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;">
                    <h4 style="font-size:0.85rem;color:#a855f7;margin-bottom:0.5rem;">Grid Search Optimization</h4>
                    <div style="font-size:12px;color:var(--text-dim);line-height:1.7;">
                        <strong>Bergstra &amp; Bengio (2012)</strong> &mdash; Random Search for Hyper-Parameter Optimization. Grid search guaranteed to find optimum in finite parameter spaces. Our implementation searches all TP/SL/Hold combinations exhaustively.
                    </div>
                </div>
                <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;">
                    <h4 style="font-size:0.85rem;color:#a855f7;margin-bottom:0.5rem;">Walk-Forward Validation</h4>
                    <div style="font-size:12px;color:var(--text-dim);line-height:1.7;">
                        <strong>Pardo (2008)</strong> &mdash; The Evaluation and Optimization of Trading Strategies. Gold standard for avoiding overfitting. <span style="color:#22c55e;">DEPLOYED</span> via <code>walk_forward_validator.py</code> &mdash; rolling window validation with walk-forward efficiency ratio tracking.
                    </div>
                </div>
                <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;">
                    <h4 style="font-size:0.85rem;color:#a855f7;margin-bottom:0.5rem;">Regime Detection (HMM)</h4>
                    <div style="font-size:12px;color:var(--text-dim);line-height:1.7;">
                        <strong>Hamilton (1989)</strong> &mdash; Hidden Markov Models for regime switching. Foundation of our HMM-based regime gate that protects 19/20 algorithms from trading in adverse conditions.
                    </div>
                </div>
                <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;">
                    <h4 style="font-size:0.85rem;color:#a855f7;margin-bottom:0.5rem;">Kelly Criterion</h4>
                    <div style="font-size:12px;color:var(--text-dim);line-height:1.7;">
                        <strong>Kelly (1956)</strong> &mdash; A New Interpretation of Information Rate. Half-Kelly sizing balances growth and ruin avoidance. Currently not used (fixed 5% sizing) &mdash; planned upgrade.
                    </div>
                </div>
                <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;">
                    <h4 style="font-size:0.85rem;color:#a855f7;margin-bottom:0.5rem;">Meta-Labeling</h4>
                    <div style="font-size:12px;color:var(--text-dim);line-height:1.7;">
                        <strong>de Prado (2018)</strong> &mdash; Advances in Financial Machine Learning. Filter signals by ML-predicted quality. Not yet implemented &mdash; would add a secondary ML layer to filter low-quality entry signals before execution.
                    </div>
                </div>
                <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;">
                    <h4 style="font-size:0.85rem;color:#a855f7;margin-bottom:0.5rem;">Deflated Sharpe Ratio</h4>
                    <div style="font-size:12px;color:var(--text-dim);line-height:1.7;">
                        <strong>Bailey &amp; Lopez de Prado (2014)</strong> &mdash; Corrects Sharpe ratio for multiple testing bias. Essential when comparing 20 algorithms &mdash; prevents selecting the "luckiest" strategy by chance.
                    </div>
                </div>
            </div>

            <!-- World-Class Benchmark Comparison -->
            <h4 style="font-size:0.9rem;margin-bottom:0.75rem;color:#a855f7;">World-Class Benchmark Comparison</h4>
            <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;margin-bottom:1.5rem;">
                <table style="width:100%;font-size:12px;border-collapse:collapse;">
                    <thead><tr style="border-bottom:1px solid var(--border);">
                        <th style="text-align:left;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">Metric</th>
                        <th style="text-align:center;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">World-Class Target</th>
                        <th style="text-align:center;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">Our Current</th>
                        <th style="text-align:left;padding:6px 8px;color:var(--text-dim);font-size:11px;text-transform:uppercase;">Gap Assessment</th>
                    </tr></thead>
                    <tbody style="color:var(--text);">
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;">Win Rate</td><td style="padding:6px 8px;text-align:center;">55-65%</td><td style="padding:6px 8px;text-align:center;color:var(--yellow);">58.33% (12 trades)</td><td style="padding:6px 8px;color:var(--yellow);">On target but sample size too small</td></tr>
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;">Profit Factor</td><td style="padding:6px 8px;text-align:center;">1.5-3.0</td><td style="padding:6px 8px;text-align:center;color:var(--green);">2.61</td><td style="padding:6px 8px;color:var(--green);">On target (if sustained)</td></tr>
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;">Sharpe Ratio</td><td style="padding:6px 8px;text-align:center;">2.0-6.0 (Renaissance)</td><td style="padding:6px 8px;text-align:center;color:var(--text-dim);">TBD</td><td style="padding:6px 8px;color:var(--red);">Cannot compute yet (need 50+ trades)</td></tr>
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;">ML Pipeline</td><td style="padding:6px 8px;text-align:center;">Full (meta-label + regime + sizing)</td><td style="padding:6px 8px;text-align:center;color:var(--green);">Grid search + regime + walk-forward + drift + online learning</td><td style="padding:6px 8px;color:var(--yellow);">Missing meta-label, EGARCH</td></tr>
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;">Algorithms</td><td style="padding:6px 8px;text-align:center;">50-200 (top firms)</td><td style="padding:6px 8px;text-align:center;color:var(--yellow);">20</td><td style="padding:6px 8px;color:var(--yellow);">Adequate but could grow</td></tr>
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;">Walk-Forward</td><td style="padding:6px 8px;text-align:center;">Required</td><td style="padding:6px 8px;text-align:center;color:var(--green);"><span style="color:#22c55e;">DEPLOYED</span></td><td style="padding:6px 8px;color:var(--green);">walk_forward_validator.py live</td></tr>
                        <tr style="border-bottom:1px solid rgba(42,42,74,0.5);"><td style="padding:6px 8px;">Position Sizing</td><td style="padding:6px 8px;text-align:center;">EGARCH/vol-targeted</td><td style="padding:6px 8px;text-align:center;color:var(--red);">Fixed 5%</td><td style="padding:6px 8px;color:var(--red);">Major gap</td></tr>
                        <tr><td style="padding:6px 8px;">Data Sources</td><td style="padding:6px 8px;text-align:center;">10-50</td><td style="padding:6px 8px;text-align:center;color:var(--yellow);">3</td><td style="padding:6px 8px;color:var(--yellow);">Limited (FreeCrypto, TwelveData, Finnhub)</td></tr>
                    </tbody>
                </table>
            </div>

            <!-- Future Priorities -->
            <h4 style="font-size:0.9rem;margin-bottom:0.75rem;color:#a855f7;">Future Priorities (Ranked)</h4>
            <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.2rem;margin-bottom:1.5rem;">
                <div style="font-size:12px;color:var(--text-dim);line-height:2;">
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:2px;">
                        <span style="display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:700;background:rgba(239,68,68,0.15);color:#ef4444;border:1px solid rgba(239,68,68,0.3);min-width:28px;text-align:center;">P1</span>
                        <span><strong style="color:var(--text);">Deploy backtested A/A+ algos via bridge</strong> &mdash; fix zero forward/backtest overlap</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:2px;">
                        <span style="display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:700;background:rgba(34,197,94,0.15);color:#22c55e;border:1px solid rgba(34,197,94,0.3);min-width:28px;text-align:center;">P2</span>
                        <span><strong style="color:var(--text);">Walk-forward validation</strong> &mdash; <span style="color:#22c55e;">DEPLOYED</span> (<code>walk_forward_validator.py</code>) &mdash; prevents overfitting learned params (Pardo 2008)</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:2px;">
                        <span style="display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:700;background:rgba(234,179,8,0.15);color:#eab308;border:1px solid rgba(234,179,8,0.3);min-width:28px;text-align:center;">P3</span>
                        <span><strong style="color:var(--text);">EGARCH position sizing</strong> &mdash; volatility-adjusted instead of fixed 5%</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:2px;">
                        <span style="display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:700;background:rgba(234,179,8,0.15);color:#eab308;border:1px solid rgba(234,179,8,0.3);min-width:28px;text-align:center;">P4</span>
                        <span><strong style="color:var(--text);">Ensemble weighting</strong> &mdash; Sharpe-weighted algorithm combination</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:2px;">
                        <span style="display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:700;background:rgba(59,130,246,0.15);color:#3b82f6;border:1px solid rgba(59,130,246,0.3);min-width:28px;text-align:center;">P5</span>
                        <span><strong style="color:var(--text);">Meta-label integration</strong> &mdash; filter low-quality signals before execution (de Prado 2018)</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:2px;">
                        <span style="display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:700;background:rgba(59,130,246,0.15);color:#3b82f6;border:1px solid rgba(59,130,246,0.3);min-width:28px;text-align:center;">P6</span>
                        <span><strong style="color:var(--text);">Expand grid search</strong> &mdash; include entry signal parameters, not just TP/SL/Hold</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;margin-bottom:2px;">
                        <span style="display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:700;background:rgba(168,85,247,0.15);color:#a855f7;border:1px solid rgba(168,85,247,0.3);min-width:28px;text-align:center;">P7</span>
                        <span><strong style="color:var(--text);">Cross-asset correlation pruning</strong> &mdash; avoid redundant correlated signals</span>
                    </div>
                    <div style="display:flex;align-items:center;gap:8px;">
                        <span style="display:inline-block;padding:2px 8px;border-radius:4px;font-size:10px;font-weight:700;background:rgba(168,85,247,0.15);color:#a855f7;border:1px solid rgba(168,85,247,0.3);min-width:28px;text-align:center;">P8</span>
                        <span><strong style="color:var(--text);">Real-time regime adaptation</strong> &mdash; not just daily, intraday regime updates</span>
                    </div>
                </div>
            </div>

            <!-- The Hard Truth -->
            <div style="background:linear-gradient(135deg,rgba(168,85,247,0.06),rgba(239,68,68,0.06));border:1px solid rgba(168,85,247,0.3);border-radius:var(--radius);padding:1.2rem;margin-bottom:1.5rem;">
                <h4 style="font-size:0.9rem;color:#a855f7;margin-bottom:0.5rem;">The Hard Truth</h4>
                <div style="font-size:12px;color:var(--text-dim);line-height:1.7;">
                    Our 58.33% WR and 2.61 PF are promising but based on <strong style="color:var(--red);">only 12 trades</strong> &mdash; this is noise, not signal. Renaissance Technologies runs millions of trades; we need 100+ minimum before ANY statistical conclusion. The grid search learning is genuinely improving parameters (Ichimoku TP +70%). Walk-forward validation is now <span style="color:#22c55e;">DEPLOYED</span> to guard against overfitting, along with concept drift detection and online incremental learning. <strong style="color:var(--text);">The system architecture is institutional-grade; the data volume is not.</strong>
                </div>
            </div>

            <!-- Sources -->
            <p style="font-size:0.75rem;color:var(--text-dim);line-height:1.6;">
                <strong>Academic Sources:</strong> Bergstra &amp; Bengio (2012), Pardo (2008), Hamilton (1989), Kelly (1956), de Prado (2018), Bailey &amp; Lopez de Prado (2014), Narang &mdash; Inside the Black Box (2013).
            </p>
        </div>
    </div>

    <!-- Data Sources & Transparency -->
    <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:var(--radius);padding:1.25rem;margin:0 1.5rem 1.5rem;">
        <h3 style="font-size:1rem;margin-bottom:0.75rem;display:flex;align-items:center;gap:8px;">
            Data Sources & Transparency
            <span style="font-size:10px;padding:2px 8px;border-radius:4px;background:rgba(255,215,0,0.15);color:#ffd700;border:1px solid rgba(255,215,0,0.3);">VERIFIED</span>
        </h3>
        <div style="font-size:12px;color:var(--text-dim);line-height:1.8;">
            <strong style="color:var(--text);">Where the numbers come from:</strong><br>
            &bull; <strong>Summary stats:</strong> <a href="api/algo_performance.php?action=summary&days=30" target="_blank">algo_performance.php?action=summary</a> &mdash; win rate, P&L, trade count<br>
            &bull; <strong>By algorithm:</strong> <a href="api/algo_performance.php?action=by_algorithm&days=30" target="_blank">algo_performance.php?action=by_algorithm</a> &mdash; per-algo breakdown<br>
            &bull; <strong>By asset class:</strong> <a href="api/algo_performance.php?action=by_asset&days=30" target="_blank">algo_performance.php?action=by_asset</a> &mdash; crypto/forex/stock split<br>
            &bull; <strong>Trade log:</strong> <a href="api/algo_performance.php?action=trades&days=30" target="_blank">algo_performance.php?action=trades</a> &mdash; every individual trade<br>
            &bull; <strong>Live signals:</strong> <a href="api/live_signals.php" target="_blank">live_signals.php</a> &mdash; 20 algorithms, real-time<br>
            &bull; <strong>Price verification:</strong> CoinGecko API (independent cross-check of crypto prices)<br>
            &bull; <strong>Paper trading engine:</strong> <a href="live-monitor.html" target="_blank">Live Monitor</a> &mdash; $10K capital, 5% sizing, auto SL/TP
        </div>
    </div>

    <!-- Future Roadmap -->
    <div style="background:var(--bg-card);border:1px solid rgba(255,215,0,0.3);border-radius:var(--radius);padding:1.25rem;margin:0 1.5rem 1.5rem;">
        <h3 style="font-size:1rem;margin-bottom:0.75rem;display:flex;align-items:center;gap:8px;">
            Future Roadmap
            <span style="font-size:10px;padding:2px 8px;border-radius:4px;background:rgba(34,197,94,0.15);color:#22c55e;border:1px solid rgba(34,197,94,0.3);">PLANNED</span>
        </h3>
        <div style="font-size:12px;color:var(--text-dim);line-height:1.8;">
            <strong style="color:var(--green);">Near-term:</strong><br>
            &bull; Add forex and stock trade data (currently crypto-dominant)<br>
            &bull; Expand grid search to more parameter combinations<br>
            &bull; Weekly performance digest with automated email/Discord alerts<br><br>
            <strong style="color:var(--yellow);">Q2 2026:</strong><br>
            &bull; Walk-forward optimization (rolling re-learn every 30 days)<br>
            &bull; Multi-timeframe parameter sets (1h, 4h, daily)<br>
            &bull; Drawdown analysis and risk-adjusted return metrics (Sharpe, Sortino)<br><br>
            <strong style="color:var(--text-dim);">Long-term:</strong><br>
            &bull; Ensemble voting across learned + original for highest-conviction signals<br>
            &bull; Regime-aware parameter switching (bull/bear/sideways)<br>
            &bull; Public API for algorithmic trading signals
        </div>
    </div>

    <div class="footer">
        <p>Self-Learning Performance Tracker &mdash; findtorontoevents.ca &mdash; Feb 2026</p>
        <p style="margin-top:0.3rem;">Compares hardcoded algorithm defaults vs adaptively-learned parameters from grid search optimization.</p>
    </div>

<script>
var API = '/live-monitor/api/algo_performance.php';
var chartWr = null, chartPnl = null;

function switchTab(tab) {
    var tabs = ['overview', 'algorithms', 'params', 'trades', 'analysis', 'research'];
    tabs.forEach(function(t) {
        document.getElementById('tab-' + t).style.display = t === tab ? 'block' : 'none';
    });
    document.querySelectorAll('.tab-btn').forEach(function(btn, i) {
        btn.classList.toggle('active', tabs[i] === tab);
    });
    if (tab === 'algorithms') loadAlgorithms();
    if (tab === 'params') loadParams();
    if (tab === 'trades') loadTrades();
}

// ── Overview Tab ──
function loadSummary() {
    fetch(API + '?action=summary&days=30')
        .then(function(r) { return r.json(); })
        .then(function(d) {
            if (!d.ok) return;
            var perf = d.performance;
            var learned = perf['learned'] || {trades:0,wins:0,losses:0,win_rate:0,avg_pnl:0,total_pnl:0,best_trade:0,worst_trade:0,avg_hold_hrs:0};
            var original = perf['original'] || {trades:0,wins:0,losses:0,win_rate:0,avg_pnl:0,total_pnl:0,best_trade:0,worst_trade:0,avg_hold_hrs:0};

            // Backfill bar
            if (d.untagged_signals > 0) {
                document.getElementById('backfill-bar').style.display = 'flex';
                document.getElementById('untagged-count').textContent = d.untagged_signals;
            }

            // KPI cards
            var totalTrades = learned.trades + original.trades;
            var kpiHtml = '<div class="kpi-card"><h3>Total Closed Trades</h3><div class="value">' + totalTrades + '</div>'
                + '<div class="sub"><span class="tag tag-learned">Learned: ' + learned.trades + '</span> <span class="tag tag-original">Original: ' + original.trades + '</span></div></div>';

            var wrDelta = learned.win_rate - original.win_rate;
            var wrClass = wrDelta > 0 ? 'pos' : (wrDelta < 0 ? 'neg' : '');
            kpiHtml += '<div class="kpi-card"><h3>Win Rate Delta (L vs O)</h3><div class="value ' + wrClass + '">'
                + (wrDelta > 0 ? '+' : '') + wrDelta.toFixed(1) + '%</div>'
                + '<div class="sub">Learned: ' + learned.win_rate + '% | Original: ' + original.win_rate + '%</div></div>';

            var pnlDelta = learned.avg_pnl - original.avg_pnl;
            var pnlClass = pnlDelta > 0 ? 'pos' : (pnlDelta < 0 ? 'neg' : '');
            kpiHtml += '<div class="kpi-card"><h3>Avg PnL Delta</h3><div class="value ' + pnlClass + '">'
                + (pnlDelta > 0 ? '+' : '') + pnlDelta.toFixed(4) + '%</div>'
                + '<div class="sub">Learned: ' + learned.avg_pnl.toFixed(4) + '% | Original: ' + original.avg_pnl.toFixed(4) + '%</div></div>';

            kpiHtml += '<div class="kpi-card"><h3>Total PnL (30d)</h3>'
                + '<div class="value">L: <span class="' + (learned.total_pnl >= 0 ? 'pos' : 'neg') + '">' + learned.total_pnl.toFixed(2) + '%</span></div>'
                + '<div class="sub">Original: <span class="' + (original.total_pnl >= 0 ? 'pos' : 'neg') + '">' + original.total_pnl.toFixed(2) + '%</span></div></div>';
            document.getElementById('kpi-row').innerHTML = kpiHtml;

            // Show/hide empty state note when trade counts are very low
            var emptyNote = document.getElementById('algo-empty-note');
            if (emptyNote) {
                var lowData = (learned.trades <= 2 && original.trades <= 2);
                emptyNote.style.display = lowData ? 'block' : 'none';
            }

            // Compare boxes
            var cHtml = '';
            cHtml += renderCompareBox('Self-Learned Parameters', 'learned-box', learned);
            cHtml += renderCompareBox('Original Defaults', 'original-box', original);
            document.getElementById('compare-grid').innerHTML = cHtml;
        });

    // Asset-class chart
    fetch(API + '?action=by_asset&days=30')
        .then(function(r) { return r.json(); })
        .then(function(d) {
            if (!d.ok) return;
            var labels = [], lData = [], oData = [];
            for (var ac in d.assets) {
                labels.push(ac);
                lData.push(d.assets[ac]['learned'] ? d.assets[ac]['learned'].win_rate : 0);
                oData.push(d.assets[ac]['original'] ? d.assets[ac]['original'].win_rate : 0);
            }
            if (chartWr) chartWr.destroy();
            chartWr = new Chart(document.getElementById('chart-wr'), {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'Learned', data: lData, backgroundColor: 'rgba(99,102,241,0.7)' },
                        { label: 'Original', data: oData, backgroundColor: 'rgba(234,179,8,0.7)' }
                    ]
                },
                options: { responsive: true, plugins: { legend: { labels: { color: '#8888aa' } } }, scales: { x: { ticks: { color: '#8888aa' } }, y: { ticks: { color: '#8888aa' }, title: { display: true, text: 'Win Rate %', color: '#8888aa' } } } }
            });
        });
}

function renderCompareBox(title, cls, data) {
    return '<div class="compare-box ' + cls + '">'
        + '<h2>' + title + '</h2>'
        + metric('Trades', data.trades)
        + metric('Wins / Losses', data.wins + ' / ' + data.losses)
        + metric('Win Rate', data.win_rate + '%', data.win_rate >= 50 ? 'pos' : 'neg')
        + metric('Avg PnL', data.avg_pnl.toFixed(4) + '%', data.avg_pnl >= 0 ? 'pos' : 'neg')
        + metric('Total PnL', data.total_pnl.toFixed(2) + '%', data.total_pnl >= 0 ? 'pos' : 'neg')
        + metric('Best Trade', '+' + data.best_trade.toFixed(2) + '%', 'pos')
        + metric('Worst Trade', data.worst_trade.toFixed(2) + '%', 'neg')
        + metric('Avg Hold', data.avg_hold_hrs + 'h')
        + '</div>';
}
function metric(label, value, cls) {
    return '<div class="metric-row"><span class="metric-label">' + label + '</span><span class="metric-value ' + (cls||'') + '">' + value + '</span></div>';
}

// ── Algorithms Tab ──
function loadAlgorithms() {
    fetch(API + '?action=by_algorithm&days=30')
        .then(function(r) { return r.json(); })
        .then(function(d) {
            if (!d.ok) return;
            var tbody = document.getElementById('algo-tbody');
            tbody.innerHTML = '';
            var chartLabels = [], chartL = [], chartO = [];
            d.algorithms.forEach(function(a) {
                ['learned', 'original'].forEach(function(src) {
                    var data = a[src];
                    if (!data) return;
                    var tr = document.createElement('tr');
                    var pnlCls = data.avg_pnl >= 0 ? 'pos' : 'neg';
                    tr.innerHTML = '<td><strong>' + esc(a.algorithm) + '</strong></td>'
                        + '<td><span class="tag tag-' + src + '">' + src + '</span></td>'
                        + '<td>' + data.trades + '</td>'
                        + '<td class="' + (data.win_rate >= 50 ? 'pos' : 'neg') + '">' + data.win_rate + '%</td>'
                        + '<td class="' + pnlCls + '">' + data.avg_pnl.toFixed(4) + '%</td>'
                        + '<td class="' + (data.total_pnl >= 0 ? 'pos' : 'neg') + '">' + data.total_pnl.toFixed(2) + '%</td>'
                        + '<td>' + data.avg_tp + '%</td>'
                        + '<td>' + data.avg_sl + '%</td>'
                        + '<td>' + data.avg_hold + 'h</td>';
                    tbody.appendChild(tr);
                });
                // Chart data
                chartLabels.push(a.algorithm.substring(0, 12));
                chartL.push(a.learned ? a.learned.avg_pnl : 0);
                chartO.push(a.original ? a.original.avg_pnl : 0);
            });
            if (chartPnl) chartPnl.destroy();
            chartPnl = new Chart(document.getElementById('chart-algo-pnl'), {
                type: 'bar',
                data: {
                    labels: chartLabels,
                    datasets: [
                        { label: 'Learned Avg PnL%', data: chartL, backgroundColor: 'rgba(99,102,241,0.7)' },
                        { label: 'Original Avg PnL%', data: chartO, backgroundColor: 'rgba(234,179,8,0.7)' }
                    ]
                },
                options: { responsive: true, indexAxis: 'y', plugins: { legend: { labels: { color: '#8888aa' } } }, scales: { x: { ticks: { color: '#8888aa' } }, y: { ticks: { color: '#8888aa', font: { size: 10 } } } } }
            });
        });
}

// ── Params Tab ──
function loadParams() {
    fetch(API + '?action=learned_params')
        .then(function(r) { return r.json(); })
        .then(function(d) {
            if (!d.ok) return;
            var tbody = document.getElementById('params-tbody');
            tbody.innerHTML = '';
            d.params.forEach(function(p) {
                var tr = document.createElement('tr');
                var verdictCls = p.verdict === 'IMPROVED' ? 'pos' : (p.verdict === 'NO_PROFITABLE_PARAMS' ? 'neg' : '');
                var wrDelta = p.learned_wr - p.original_wr;
                tr.innerHTML = '<td><strong>' + esc(p.algorithm) + '</strong></td>'
                    + '<td>' + p.asset_class + '</td>'
                    + '<td>' + p.original.tp + '%</td>'
                    + '<td style="color:var(--accent)">' + p.learned.tp + '%</td>'
                    + '<td>' + p.original.sl + '%</td>'
                    + '<td style="color:var(--accent)">' + p.learned.sl + '%</td>'
                    + '<td>' + p.original.hold + 'h</td>'
                    + '<td style="color:var(--accent)">' + p.learned.hold + 'h</td>'
                    + '<td>' + p.original_wr.toFixed(1) + '%</td>'
                    + '<td class="' + (wrDelta >= 0 ? 'pos' : 'neg') + '">' + p.learned_wr.toFixed(1) + '%</td>'
                    + '<td class="' + verdictCls + '">' + p.verdict + '</td>';
                tbody.appendChild(tr);
            });
        });
}

// ── Trades Tab ──
function loadTrades() {
    fetch(API + '?action=trades&limit=100')
        .then(function(r) { return r.json(); })
        .then(function(d) {
            if (!d.ok) return;
            var tbody = document.getElementById('trades-tbody');
            tbody.innerHTML = '';
            d.trades.forEach(function(t) {
                var tr = document.createElement('tr');
                var pnlCls = t.pnl_pct > 0 ? 'pos' : 'neg';
                var badge = t.pnl_pct > 0 ? '<span class="badge-win">WIN</span>' : '<span class="badge-loss">LOSS</span>';
                tr.innerHTML = '<td style="font-size:11px">' + (t.exit_time || '').substring(0, 16) + '</td>'
                    + '<td><strong>' + esc(t.symbol) + '</strong></td>'
                    + '<td style="font-size:12px">' + esc(t.algorithm) + '</td>'
                    + '<td>' + t.direction + '</td>'
                    + '<td><span class="tag tag-' + t.param_source + '">' + t.param_source + '</span></td>'
                    + '<td>$' + t.entry_price.toFixed(4) + '</td>'
                    + '<td>$' + t.exit_price.toFixed(4) + '</td>'
                    + '<td class="' + pnlCls + '">' + (t.pnl_pct > 0 ? '+' : '') + t.pnl_pct.toFixed(4) + '% ' + badge + '</td>'
                    + '<td>' + (t.exit_reason || '') + '</td>'
                    + '<td style="font-size:11px">' + t.params_used.tp + '/' + t.params_used.sl + '/' + t.params_used.hold + 'h</td>'
                    + '<td style="font-size:11px;color:var(--text-dim)">' + t.params_original.tp + '/' + t.params_original.sl + '/' + t.params_original.hold + 'h</td>';
                tbody.appendChild(tr);
            });
        });
}

function runBackfill() {
    fetch(API + '?action=backfill&key=livetrader2026')
        .then(function(r) { return r.json(); })
        .then(function(d) {
            if (d.ok) {
                alert('Backfill complete: ' + d.tagged_learned + ' learned, ' + d.tagged_original + ' original. ' + d.remaining + ' remaining.');
                if (d.remaining === 0) document.getElementById('backfill-bar').style.display = 'none';
                loadSummary();
            } else {
                alert('Backfill error: ' + (d.error || 'unknown'));
            }
        });
}

function esc(s) { if (!s) return ''; var d = document.createElement('div'); d.textContent = s; return d.innerHTML; }

// ── Gold Banner — live data ──
function loadGoldBanner() {
    var now = new Date();
    var ts = document.getElementById('gold-timestamp');
    if (ts) ts.textContent = 'Verified: ' + now.toLocaleString('en-US', {month:'short',day:'numeric',year:'numeric',hour:'2-digit',minute:'2-digit',timeZoneName:'short'});

    fetch(API + '?action=summary&days=30')
        .then(function(r) { return r.json(); })
        .then(function(d) {
            if (!d.ok) return;
            var learned = d.performance['learned'] || {};
            var original = d.performance['original'] || {};
            var wr = document.getElementById('gold-wr');
            var pnl = document.getElementById('gold-pnl');
            if (wr && learned.win_rate !== undefined) wr.textContent = learned.win_rate + '%';
            if (pnl && learned.total_pnl !== undefined) pnl.textContent = (learned.total_pnl >= 0 ? '+' : '') + learned.total_pnl.toFixed(2) + '%';
            // Populate closed trade count in banner paragraph
            var closedEl = document.getElementById('gold-closed-count');
            if (closedEl) {
                var totalClosed = (learned.trades || 0) + (original.trades || 0);
                closedEl.textContent = totalClosed;
            }
        });
    fetch(API + '?action=by_asset&days=30')
        .then(function(r) { return r.json(); })
        .then(function(d) {
            if (!d.ok) return;
            var crypto = d.assets['CRYPTO'] && d.assets['CRYPTO']['learned'];
            if (crypto) {
                var cwr = document.getElementById('gold-crypto-wr');
                var cpnl = document.getElementById('gold-crypto-pnl');
                if (cwr) cwr.textContent = crypto.win_rate + '%';
                if (cpnl) cpnl.textContent = (crypto.total_pnl >= 0 ? '+' : '') + crypto.total_pnl.toFixed(1) + '%';
            }
        });
    fetch(API + '?action=by_algorithm&days=30')
        .then(function(r) { return r.json(); })
        .then(function(d) {
            if (!d.ok) return;
            var best = null;
            d.algorithms.forEach(function(a) {
                if (a.learned && a.learned.trades > 0) {
                    if (!best || a.learned.total_pnl > best.pnl) {
                        best = { name: a.algorithm, pnl: a.learned.total_pnl, wr: a.learned.win_rate };
                    }
                }
            });
            var el = document.getElementById('gold-top-algo');
            if (el && best) el.textContent = best.name + ' (' + best.wr + '% WR)';
        });
}

// Auto-load
loadGoldBanner();
loadSummary();
</script>
<div style="text-align:center;font-size:0.7rem;color:#555577;padding:1.5rem;border-top:1px solid #1e1e3a;margin-top:1rem;">Paper trading simulation only. Not financial advice. Past performance does not guarantee future results.</div>
<script src="/findstocks/portfolio2/stock-nav.js"></script>
</body>
</html>
