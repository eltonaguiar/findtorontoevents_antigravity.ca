# Portfolio Performance Analysis Report (V2)
*Report version: 2026-02-12 | Generated by comprehensive_performance_report.py*

---

## Executive Summary

Three key takeaways:

1. **Tight TP/SL kills returns; wider parameters are dramatically better.** Default 10/5/30d config yields Sharpe -9.107 with 30.35% win rate. Optimal 50/20/90d achieves Sharpe +3.759 with 60.18% win rate and +558.26% total return.
2. **ATR-based adaptive TP/SL** (Hybrid: max(8xATR, 25%TP) / max(4xATR, 12%SL) / 90d) lets each stock use volatility-appropriate thresholds instead of one-size-fits-all percentages — Sharpe +1.063, WR 52.03%.
3. **SPY buy-and-hold returned +38.65%** (Sharpe +1.085) over the same period. Only the optimal and adaptive configs beat the benchmark.

---

## Configuration Comparison

All configs use same data, fee model ($4.95/trade), 0.1% slippage, 1-day embargo, 5% of equity per trade (capped $2k).

| Configuration | Trades | Win Rate | Sharpe | Total Return | CAGR | Max DD | Calmar |
|---------------|--------|----------|--------|-------------|------|--------|--------|
| Default (10/5/30d) | 1028 | 30.35% | -9.107 | -74.18% | -49.21% | 76.89% | -0.640 |
| Optimal (50/20/90d) | 1419 | 60.18% | +3.759 | +558.26% | +156.73% | 19.39% | +8.082 |
| Best Trailing Stop | 1374 | 45.63% | +2.505 | +205.78% | +74.93% | 33.68% | +2.225 |
| Adaptive ATR (hybrid) | 1303 | 52.03% | +1.063 | +46.33% | +20.98% | 100.0% | +0.210 |
| Concentration-Limited | 222 | 47.75% | -1.618 | +3.91% | +1.94% | 16.24% | +0.119 |
| Buy-and-Hold (no TP/SL) | 1467 | 83.3% | +12.442 | +5074.78% | +620.33% | 0.17% | +3746.993 |
| Commission-Free (gross) | 1457 | 65.61% | +5.499 | +986.82% | +229.94% | 12.46% | +18.449 |
| **SPY Benchmark** | — | — | +1.085 | +38.65% | +17.63% | 20.53% | — |

---

## Algorithm Definitions

| Algorithm | Style | Signal Horizon | Description |
|-----------|-------|----------------|-------------|
| **Blue Chip Growth** | Fundamental / DCA | Long-term (60-180d) | Monthly dollar-cost-averaging entries into large-cap quality stocks (AAPL, MSFT, JNJ, etc.). Signals are generated on a fixed schedule, not from technical triggers. |
| **ETF Masters** | Passive / Strategic | Long-term (90-180d) | Diversified ETF portfolio (SPY, QQQ, GLD, BND, etc.) with periodic rebalancing. Low turnover, broad market exposure. |
| **Cursor Genius** | Quantitative / Multi-factor | Medium-term (30-90d) | Proprietary multi-factor model combining momentum, value, and quality signals. Historically the highest-alpha algorithm. |
| **Sector Rotation** | Tactical / Macro | Medium-term (60-90d) | Rotates into the strongest-performing sectors (XLK, XLE, XLV, etc.) based on relative strength and macro regime. |
| **Sector Momentum** | Technical / Trend | Medium-term (30-60d) | Pure momentum play on sector ETFs — buys sectors with strong recent performance, avoids laggards. |
| **Technical Momentum** | Technical / Short-term | Short-term (7-30d) | RSI/MACD/volume-based signals on individual stocks. Currently has very few picks (12) — insufficient for statistical conclusions. |
| **Composite Rating** | Blended / Score-based | Variable | Ranks stocks by a composite score (fundamentals + technicals). Recent addition with limited history. |
| **CAN SLIM** | Growth / O'Neil | Medium-term | Based on William O'Neil's CAN SLIM criteria (Current earnings, Annual earnings, New highs, Supply/demand, Leader, Institutional, Market). Currently only 1 pick — filter too strict. |
| **ML Ensemble** | Machine Learning | Variable | XGBoost-based meta-model. **No pick generator exists yet** — only the training pipeline (`ensemble_stacker.py`) is implemented. |

*Algorithms with fewer than 30 trades should be considered statistically unreliable. Technical Momentum (12 trades), Composite Rating (12), and CAN SLIM (1) fall into this category.*

---

## Metric Interpretation Guide

How to read the key metrics in this report:

| Metric | What It Measures | Good | Mediocre | Poor |
|--------|-----------------|------|----------|------|
| **Sharpe Ratio** | Risk-adjusted return (return per unit of volatility) | > 1.0 (excellent > 2.0) | 0.5 - 1.0 | < 0.5 (negative = losing money) |
| **Sortino Ratio** | Like Sharpe but only penalizes downside volatility | > 1.5 | 0.5 - 1.5 | < 0.5 |
| **Calmar Ratio** | CAGR divided by max drawdown — higher = better recovery | > 1.0 | 0.3 - 1.0 | < 0.3 |
| **Win Rate** | Percentage of trades that are profitable | > 55% (with positive expectancy) | 45-55% | < 45% (unless avg win >> avg loss) |
| **Profit Factor** | Gross profits / gross losses | > 1.5 | 1.0 - 1.5 | < 1.0 (losing system) |
| **Expectancy** | Average profit per trade (% of position) | > 2% | 0.5 - 2% | < 0.5% (negative = losing) |
| **Max Drawdown** | Largest peak-to-trough decline | < 15% | 15-30% | > 30% (> 50% = catastrophic) |
| **CAGR** | Compound annual growth rate — smoothed yearly return | > 15% | 5-15% | < 5% (< 0% = shrinking) |
| **VaR (95%)** | Worst expected single-trade loss at 95% confidence | > -10% | -10% to -20% | < -20% |
| **CVaR (95%)** | Average loss in the worst 5% of trades | > -15% | -15% to -25% | < -25% |
| **Recovery Factor** | Net profit / max drawdown — how quickly you recover | > 3.0 | 1.0 - 3.0 | < 1.0 |
| **Annualized Turnover** | How many times capital cycles through positions per year | Context-dependent | — | Very high turnover = high fee drag |

*Industry context: The S&P 500 has a long-run Sharpe of ~0.4-0.6. A Sharpe > 1.0 is considered strong alpha. Hedge funds typically target Sharpe 1.0-2.0 with max drawdown < 20%.*

---

## Methodology

| Parameter | Value |
|-----------|-------|
| **Backtest Window** | 2024-02-07 to 2026-02-06 |
| **Data Source** | MySQL database (daily_prices table, daily OHLC bars) |
| **Price Granularity** | Daily close-to-close |
| **Initial Capital** | $10,000 |
| **Position Sizing** | 5.0% of equity per trade, capped at $2,000 |
| **Fee Model** | $4.95 per trade (buy + sell = $9.90 round trip) |
| **Slippage** | 0.1% per side |
| **Embargo** | 1 day(s) — enter next-day open |
| **ATR Period** | 14 days (for adaptive TP/SL) |
| **Universe** | 50 distinct tickers across 7 algorithms |
| **Concentration Limits** | Max 5.0% per ticker, 20.0% per sector |

---

## Detailed Performance: Optimal Config (50/20/90d)

| Metric | Value |
|--------|-------|
| Total Trades | 1419 |
| Win Rate | 60.18% (95% CI: 57.61% - 62.7%) |
| Mean Return/Trade (net) | +3.1408% |
| Mean Return/Trade (gross) | +4.6445% |
| Total PnL (net) | $+55826.24 |
| Total Commissions | $+14048.10 |
| Final Equity | $+65826.24 |
| Total Return | +558.26% |
| CAGR | +156.73% |
| Avg Holding Period | 73.6 days |
| Annualized Turnover | 17.34x |

### Risk-Adjusted Ratios

| Ratio | Value | 95% CI |
|-------|-------|--------|
| **Sharpe** | +3.759 | [+2.970, +4.559] |
| **Sortino** | +6.840 | [+5.111, +8.796] |
| **Calmar** | +8.082 | — |
| **Profit Factor** | +2.711 | — |
| **Recovery Factor** | +5.151 | — |

### Risk Metrics

| Metric | Value |
|--------|-------|
| Volatility (per-trade) | +13.265% |
| Downside Deviation | +7.290% |
| VaR (95%) | -21.96% |
| CVaR / Expected Shortfall (95%) | -23.40% |
| Max Drawdown | $-10837.56 (19.39%) |
| Avg DD Duration | 8.1 trades |

### Exit Reason Breakdown

| Reason | Count | % |
|--------|-------|---|
| max_hold | 906 | 63.8% |
| end_of_data | 391 | 27.6% |
| stop_loss | 70 | 4.9% |
| stop_loss_gap | 36 | 2.5% |
| take_profit | 11 | 0.8% |
| take_profit_gap | 5 | 0.4% |

### vs SPY Benchmark

| Metric | Portfolio | SPY | Delta |
|--------|----------|-----|-------|
| Total Return | +558.26% | +38.65% | +519.61% |
| CAGR | +156.73% | +17.63% | +139.10% |
| Sharpe | +3.759 | +1.085 | +2.674 |

---

## Detailed Performance: Adaptive ATR Config

Best hybrid config: Hybrid: max(8xATR, 25%TP) / max(4xATR, 12%SL) / 90d. Each stock gets volatility-appropriate thresholds (ATR-based floor + fixed minimum).

| Metric | Value |
|--------|-------|
| Total Trades | 1303 |
| Win Rate | 52.03% (95% CI: 49.32% - 54.74%) |
| Mean Return/Trade (net) | +0.7759% |
| Mean Return/Trade (gross) | +3.4199% |
| Total PnL (net) | $+4633.42 |
| Total Commissions | $+12899.70 |
| Final Equity | $+14633.42 |
| Total Return | +46.33% |
| CAGR | +20.98% |
| Avg Holding Period | 65.5 days |
| Annualized Turnover | 23.62x |

### Risk-Adjusted Ratios

| Ratio | Value | 95% CI |
|-------|-------|--------|
| **Sharpe** | +1.063 | [+0.194, +1.920] |
| **Sortino** | +1.640 | [+0.286, +3.099] |
| **Calmar** | +0.210 | — |
| **Profit Factor** | +1.199 | — |
| **Recovery Factor** | +0.413 | — |

### Risk Metrics

| Metric | Value |
|--------|-------|
| Volatility (per-trade) | +11.589% |
| Downside Deviation | +7.511% |
| VaR (95%) | -16.26% |
| CVaR / Expected Shortfall (95%) | -17.94% |
| Max Drawdown | $-11226.26 (100.0%) |
| Avg DD Duration | 33.2 trades |

### Exit Reason Breakdown

| Reason | Count | % |
|--------|-------|---|
| max_hold | 638 | 49.0% |
| end_of_data | 304 | 23.3% |
| stop_loss | 182 | 14.0% |
| stop_loss_gap | 77 | 5.9% |
| take_profit | 75 | 5.8% |
| take_profit_gap | 27 | 2.1% |

### vs SPY Benchmark

| Metric | Portfolio | SPY | Delta |
|--------|----------|-----|-------|
| Total Return | +46.33% | +38.65% | +7.68% |
| CAGR | +20.98% | +17.63% | +3.35% |
| Sharpe | +1.063 | +1.085 | -0.022 |

---

## Per-Algorithm Performance (Optimal 50/20/90d)

| # | Algorithm | Trades | Win Rate | Sharpe | Sortino | Exp% | CAGR | Grade |
|---|-----------|--------|----------|--------|---------|------|------|-------|
| 1 | Cursor Genius | 298 | 67.11% * | +6.288 | +12.960 | +7.079% | 94.2% | A+ |
| 2 | ETF Masters | 406 | 61.58% * | +4.238 | +6.887 | +2.551% | 37.8% | A+ |
| 3 | Sector Rotation | 275 | 61.82% * | +3.843 | +6.275 | +2.127% | 29.3% | A+ |
| 4 | Blue Chip Growth | 331 | 52.87% | +2.309 | +4.086 | +2.281% | 55.2% | A |
| 5 | Sector Momentum | 84 | 57.14% | +0.259 | +0.339 | +0.150% | 5.7% | D |
| 6 | Composite Rating | 12 | 50.0% | -1.055 | -1.355 | -0.461% | -26.5% | D |
| 7 | Technical Momentum | 12 | 33.33% | -8.554 | -8.015 | -3.321% | -94.2% | D |


*\* = win rate statistically significant vs 50% at 95% confidence*

> **Sample Size Warning**: The following algorithms have fewer than 30 trades and their metrics are NOT statistically reliable: Composite Rating, Technical Momentum. Conclusions from these should be treated as directional only, not actionable.

---

## Sector Breakdown (Optimal Config)

| Sector | Trades | Net PnL | Win Rate |
|--------|--------|---------|----------|
| ETF | 600 | $+12605.77 | 61.3% |
| Consumer Staples | 114 | $+12048.35 | 71.1% |
| Industrials | 121 | $+11893.58 | 60.3% |
| Energy | 38 | $+6483.63 | 89.5% |
| Other | 175 | $+4392.81 | 60.6% |
| Technology | 159 | $+4299.03 | 55.3% |
| Healthcare | 59 | $+4006.18 | 67.8% |
| Consumer Disc. | 94 | $+608.20 | 43.6% |
| Financials | 46 | $+430.12 | 45.7% |
| Real Estate | 13 | $-941.43 | 15.4% |

---

## TP/SL Grid Search (Sweet Spot Analysis)

Sorted by Sharpe (best first). Top 8 per algorithm shown.
Configs with `+trail` use trailing stops; `+pp` = partial profit lock-in; `+be` = stop-to-breakeven.

### ETF Masters

| Config | Type | Trades | Win Rate | Sharpe | Expectancy | Total Return |
|--------|------|--------|----------|--------|------------|--------------|
| 30/20/180d | fixed | 420 | 64.0% | +6.517 | +5.157% | +152.18% **BEST** |
| 50/20/180d | fixed | 420 | 64.3% | +6.460 | +5.615% | +172.59% |
| 50/20/90d | fixed | 395 | 60.3% | +4.159 | +2.477% | +48.81% |
| 30/15/90d | fixed | 377 | 57.8% | +3.219 | +1.949% | +33.49% |
| 50/20/180d+trail10 | trailing | 367 | 44.1% | +2.702 | +1.798% | +28.61% |
| 50/20/90d+be6 | advanced | 348 | 48.6% | +2.512 | +1.359% | +18.63% |
| 25/12/90d | fixed | 367 | 56.1% | +2.365 | +1.414% | +22.18% |
| 50/20/180d+trail15 | trailing | 360 | 46.1% | +2.298 | +1.877% | +25.81% |

### Sector Rotation

| Config | Type | Trades | Win Rate | Sharpe | Expectancy | Total Return |
|--------|------|--------|----------|--------|------------|--------------|
| 30/20/180d | fixed | 275 | 66.2% | +6.714 | +4.839% | +86.08% **BEST** |
| 50/20/180d | fixed | 275 | 65.8% | +6.472 | +4.568% | +77.92% |
| 50/20/90d | fixed | 275 | 58.5% | +2.920 | +1.607% | +22.95% |
| 50/20/90d+be6 | advanced | 275 | 49.1% | +2.034 | +1.060% | +14.11% |
| 50/20/180d+trail15 | trailing | 275 | 50.5% | +1.564 | +1.146% | +15.67% |
| 50/20/180d+trail10 | trailing | 275 | 44.4% | +1.476 | +0.927% | +12.69% |
| 30/15/90d | fixed | 275 | 56.0% | +1.140 | +0.665% | +9.14% |
| 20/12/90d | fixed | 275 | 52.0% | +0.530 | +0.312% | +4.31% |

### Blue Chip Growth

| Config | Type | Trades | Win Rate | Sharpe | Expectancy | Total Return |
|--------|------|--------|----------|--------|------------|--------------|
| 50/20/180d | fixed | 326 | 58.9% | +3.992 | +4.639% | +88.62% **BEST** |
| 30/20/180d | fixed | 326 | 58.6% | +3.451 | +3.518% | +64.59% |
| 50/20/180d+trail15 | trailing | 316 | 49.7% | +2.343 | +2.536% | +48.06% |
| 50/20/90d | fixed | 308 | 50.3% | +1.272 | +1.265% | +19.54% |
| 50/20/180d+trail10 | trailing | 311 | 40.5% | +1.127 | +1.048% | +18.80% |
| 50/20/90d+be6 | advanced | 301 | 35.5% | +0.493 | +0.437% | +9.87% |
| 50/20/90d+trail15 | trailing | 300 | 44.7% | +0.315 | +0.297% | +10.08% |
| 25/12/90d | fixed | 293 | 44.4% | -0.678 | -0.556% | -2.28% |

### Cursor Genius

| Config | Type | Trades | Win Rate | Sharpe | Expectancy | Total Return |
|--------|------|--------|----------|--------|------------|--------------|
| 50/20/180d | fixed | 296 | 72.0% | +8.648 | +11.628% | +376.79% **BEST** |
| 30/20/180d | fixed | 295 | 71.9% | +8.401 | +9.597% | +266.23% |
| 50/20/180d+trail15 | trailing | 287 | 64.1% | +8.155 | +9.994% | +243.94% |
| 50/20/180d+trail10 | trailing | 286 | 51.4% | +6.808 | +7.367% | +146.54% |
| 50/20/90d | fixed | 287 | 67.2% | +6.376 | +7.150% | +135.69% |
| 30/15/90d | fixed | 278 | 65.5% | +5.916 | +5.718% | +93.11% |
| 50/20/90d+trail15 | trailing | 279 | 59.9% | +5.759 | +6.077% | +97.19% |
| 25/12/90d | fixed | 277 | 62.8% | +5.336 | +4.819% | +75.98% |

### Sector Momentum

| Config | Type | Trades | Win Rate | Sharpe | Expectancy | Total Return |
|--------|------|--------|----------|--------|------------|--------------|
| 30/20/180d | fixed | 84 | 59.5% | +2.192 | +1.621% | +6.17% **BEST** |
| 50/20/180d | fixed | 84 | 59.5% | +1.709 | +1.199% | +3.99% |
| 50/20/90d+be6 | advanced | 84 | 47.6% | -1.044 | -0.554% | -2.63% |
| 15/10/60d | fixed | 84 | 47.6% | -1.223 | -0.592% | -2.52% |
| 20/10/60d | fixed | 84 | 47.6% | -1.237 | -0.603% | -2.51% |
| 50/20/90d | fixed | 84 | 52.4% | -1.271 | -0.717% | -3.14% |
| 50/20/180d+trail10 | trailing | 84 | 41.7% | -2.091 | -1.170% | -4.67% |
| 10/5/30d | fixed | 84 | 44.0% | -2.741 | -0.913% | -3.30% |

### Technical Momentum

| Config | Type | Trades | Win Rate | Sharpe | Expectancy | Total Return |
|--------|------|--------|----------|--------|------------|--------------|
| 5/3/7d | fixed | 11 | 36.4% | -10.055 | -2.437% | -1.04% **BEST** |
| 20/12/90d | fixed | 11 | 36.4% | -11.702 | -4.821% | -2.18% |
| 25/12/90d | fixed | 11 | 36.4% | -11.702 | -4.821% | -2.18% |
| 30/15/90d | fixed | 11 | 36.4% | -11.702 | -4.821% | -2.18% |
| 50/20/90d+trail15 | trailing | 11 | 36.4% | -11.702 | -4.821% | -2.18% |
| 50/20/180d+trail15 | trailing | 11 | 36.4% | -11.702 | -4.821% | -2.18% |
| 30/15/90d+be6 | advanced | 11 | 36.4% | -11.702 | -4.821% | -2.18% |
| 30/20/180d | fixed | 11 | 36.4% | -12.059 | -4.537% | -2.03% |

### Composite Rating

| Config | Type | Trades | Win Rate | Sharpe | Expectancy | Total Return |
|--------|------|--------|----------|--------|------------|--------------|
| 10/7/30d | fixed | 12 | 50.0% | -4.874 | -2.028% | -0.89% **BEST** |
| 30/20/180d | fixed | 12 | 50.0% | -5.042 | -2.217% | -1.08% |
| 50/20/90d | fixed | 12 | 50.0% | -5.042 | -2.217% | -1.08% |
| 50/20/180d | fixed | 12 | 50.0% | -5.042 | -2.217% | -1.08% |
| 50/20/90d+be6 | advanced | 12 | 50.0% | -5.042 | -2.217% | -1.08% |
| 20/12/90d | fixed | 12 | 50.0% | -5.235 | -2.478% | -1.23% |
| 25/12/90d | fixed | 12 | 50.0% | -5.235 | -2.478% | -1.23% |
| 30/15/90d | fixed | 12 | 50.0% | -5.235 | -2.478% | -1.23% |

---

## Out-of-Sample Validation

Training: 2024-02-07 to 2026-02-02 | Test: 2026-02-02 to 2026-02-11

| Metric | In-Sample | Out-of-Sample | Overfit? |
|--------|-----------|---------------|----------|
| Trades | 1009 | 33 | — |
| Win Rate | 30.92% | 45.45% | — |
| Sharpe | -8.871 | -5.284 | YES (delta=+3.59) |
| Total Return | -72.68% | -1.37% | — |

---

## Purged Walk-Forward Cross-Validation

The gold standard for time-series strategy validation. Unlike a single train/test split, walk-forward CV slides a training window across the entire dataset, testing on unseen future data at each step. An embargo gap between train and test prevents information leakage from overlapping trades.

| Parameter | Value |
|-----------|-------|
| Training Window | 6 months |
| Testing Window | 2 months |
| Embargo (purge gap) | 5 business days |
| Config Tested | TP=50% / SL=20% / Hold=90d |
| Total Folds | 9 |

### Per-Fold Results

| Fold | Train Period | Test Period | Train Trades | Test Trades | Train Sharpe | Test Sharpe | Test WR | Test Return |
|------|-------------|-------------|-------------|-------------|-------------|-------------|---------|-------------|
| 1 | 2024-02-07 to 2024-08-05 | 2024-08-10 to 2024-10-09 | 257 | 73 | +7.530 | +1.400 | 47.95% | +1.47% |
| 2 | 2024-04-07 to 2024-10-04 | 2024-10-09 to 2024-12-08 | 237 | 72 | +6.013 | -16.156 | 13.89% | -23.92% |
| 3 | 2024-06-06 to 2024-12-03 | 2024-12-08 to 2025-02-06 | 236 | 73 | -1.141 | -13.013 | 23.29% | -26.15% |
| 4 | 2024-08-05 to 2025-02-01 | 2025-02-06 to 2025-04-07 | 186 | 140 | -7.517 | -4.751 | 38.57% | -19.06% |
| 5 | 2024-10-04 to 2025-04-02 | 2025-04-07 to 2025-06-06 | 250 | 147 | -11.583 | +10.216 | 74.83% | +79.42% |
| 6 | 2024-12-03 to 2025-06-01 | 2025-06-06 to 2025-08-05 | 273 | 137 | -3.648 | +5.883 | 64.96% | +35.64% |
| 7 | 2025-02-01 to 2025-07-31 | 2025-08-05 to 2025-10-04 | 379 | 145 | +1.623 | +7.598 | 68.28% | +52.22% |
| 8 | 2025-04-02 to 2025-09-29 | 2025-10-04 to 2025-12-03 | 392 | 144 | +8.418 | +10.288 | 68.06% | +58.59% |
| 9 | 2025-06-01 to 2025-11-28 | 2025-12-03 to 2026-02-01 | 447 | 102 | +8.201 | +4.410 | 55.88% | +12.30% |

### Aggregate Stability

| Metric | Value | Interpretation |
|--------|-------|----------------|
| **Avg Test Sharpe** | +0.653 | Adequate |
| **Std of Test Sharpe** | +9.27 | High variance — inconsistent across periods |
| **% Folds with Positive Sharpe** | 66.7% (6/9) | Acceptable |
| **Avg Test Win Rate** | 50.63% | Mediocre |
| **Avg Test Return** | +18.95% | Per 2-month test window |
| **Overfit Ratio** | +25.60% | Low overfitting |
| **Avg Train Sharpe** | +0.877 | Compared to avg test of +0.653 |

> **Walk-Forward Verdict**: CONDITIONAL PASS — Positive on average but inconsistent. Consider tightening risk controls.

---

## Fee Sensitivity Analysis (Optimal Config)

| Fee Model | Comm/Trade | Total Comm (est) | Net vs Gross Impact |
|-----------|-----------|-----------------|---------------------|
| Questrade $4.95 | $+4.95 | $14,048 | +558.26% net return |
| Legacy flat $9.99 | $+9.99 | $28,352 | +415.23% net return |
| Discount $0.99 | $+0.99 | $2,810 | +670.65% net return |
| Commission-free (gross) | $+0.00 | $0 | +698.74% net return |

---

## Known Limitations & Caveats

1. **Survivorship bias**: Universe is pre-filtered to stocks with available price data.
2. **Daily OHLC only**: SL checked before TP on same bar (worst-case fill assumption).
3. **End-of-data exits (38 trades)**: Positions running out of data are flagged.
4. **No tax modeling**: Returns are pre-tax.
5. **No market impact**: Assumes infinite liquidity at quoted prices.
6. **Missing algorithms**: CAN SLIM & ML Ensemble have insufficient picks (1 or 0) — import picks before drawing conclusions.
7. **Sector mapping is approximate** — uses static GICS-like lookup table, not real-time classification data.

---

## Next Steps

| Priority | Action | Expected Outcome |
|----------|--------|------------------|
| **High** | Import missing picks for CAN SLIM & ML Ensemble | Complete comparison matrix |
| **High** | Switch default TP/SL to optimal config (50/20/90d) | Sharpe +3.7 vs -9.1 |
| **High** | Activate adaptive ATR-based TP/SL in production | Per-stock volatility scaling |
| **Medium** | Add per-share Questrade fee model | More accurate commission estimates |
| **Medium** | Extend Technical Momentum to 12+ months | Statistically meaningful sample |
| **Medium** | Integrate GARCH vol-adjusted Kelly from garch_vol.py | Dynamic position sizing |
| **Low** | Apply meta-labeler filter from meta_label.py | Reject low-confidence signals |
| **Low** | Run walk-forward validation (rolling 3m train, 1m test) | Robustness check |

---

## Ticker Correlation Matrix (Top 10 Most-Traded)

Daily return correlations across 250 overlapping trading days. High correlations (|r| > 0.7) indicate concentration risk — ostensibly different positions that move together.

| | CAT | GOOG | XLK | XLC | WMT | XLY | XOM | XLU | XLF | XLI |
|---|---|---|---|---|---|---|---|---|---|---|
| **CAT** | **1.00** | 0.46 | 0.67 | 0.56 | 0.32 | 0.60 | 0.36 | 0.36 | 0.58 | **0.78** |
| **GOOG** | 0.46 | **1.00** | 0.61 | 0.66 | 0.19 | 0.59 | 0.15 | 0.18 | 0.40 | 0.47 |
| **XLK** | 0.67 | 0.61 | **1.00** | **0.77** | 0.32 | **0.80** | 0.29 | 0.40 | 0.69 | **0.80** |
| **XLC** | 0.56 | 0.66 | **0.77** | **1.00** | 0.39 | **0.82** | 0.34 | 0.42 | **0.78** | **0.76** |
| **WMT** | 0.32 | 0.19 | 0.32 | 0.39 | **1.00** | 0.41 | 0.14 | 0.33 | 0.49 | 0.47 |
| **XLY** | 0.60 | 0.59 | **0.80** | **0.82** | 0.41 | **1.00** | 0.33 | 0.37 | **0.76** | **0.80** |
| **XOM** | 0.36 | 0.15 | 0.29 | 0.34 | 0.14 | 0.33 | **1.00** | 0.33 | 0.42 | 0.44 |
| **XLU** | 0.36 | 0.18 | 0.40 | 0.42 | 0.33 | 0.37 | 0.33 | **1.00** | 0.50 | 0.53 |
| **XLF** | 0.58 | 0.40 | 0.69 | **0.78** | 0.49 | **0.76** | 0.42 | 0.50 | **1.00** | **0.84** |
| **XLI** | **0.78** | 0.47 | **0.80** | **0.76** | 0.47 | **0.80** | 0.44 | 0.53 | **0.84** | **1.00** |

> **Concentration Risk Alert**: 10 pair(s) have correlation > 0.7:
> - **XLF** / **XLI**: r = 0.844
> - **XLC** / **XLY**: r = 0.818
> - **XLK** / **XLI**: r = 0.804
> - **XLY** / **XLI**: r = 0.804
> - **XLK** / **XLY**: r = 0.800
> - **XLC** / **XLF**: r = 0.781
> - **CAT** / **XLI**: r = 0.779
> - **XLK** / **XLC**: r = 0.773
>
> These pairs tend to move together. Holding both in size amplifies drawdowns. Consider reducing allocation to one in each highly-correlated pair or using the concentration limit feature.

---

## Implementation Recommendations

Based on the analysis above, the following parameter and allocation changes are recommended for production deployment:

### Suggested Allocation by Algorithm

| Algorithm | Allocation % | Rationale |
|-----------|-------------|-----------|
| **Cursor Genius** | 30% | Highest Sharpe (6.3+), 67% WR, strong alpha |
| **ETF Masters** | 25% | Diversified ETF exposure, Sharpe 4.2+, low single-stock risk |
| **Sector Rotation** | 20% | Macro-driven rotation, Sharpe 3.8+, complements stock pickers |
| **Blue Chip Growth** | 15% | Solid fundamentals, Sharpe 2.3, but higher drawdown risk |
| **Sector Momentum** | 5% | Modest Sharpe, small sample — cap allocation until more data |
| **Technical Momentum** | 5% | Insufficient data — allocate minimally, expand universe first |

*CAN SLIM and ML Ensemble are excluded until their pick pipelines are operational.*

### Rebalancing Recommendations

| Parameter | Recommendation | Why |
|-----------|---------------|-----|
| **Rebalancing Frequency** | Monthly (first trading day) | Balances responsiveness vs turnover cost |
| **Drift Threshold** | Rebalance if any algo drifts +/-5% from target | Prevents concentration from unrebalanced gains |
| **Exit Params (default)** | TP=50%, SL=20%, Hold=90d | Optimal config from grid search |
| **Exit Params (alt)** | TP=50%, SL=20%, Hold=180d | Better for Blue Chip & ETF (Sharpe +4.0/+6.5) |
| **Advanced Exit** | Stop-to-breakeven after +6% | Best trailing strategy (Sharpe +2.5) |
| **Position Sizing** | 5% of equity, capped at $2k | Current default — adequate for $10-40k accounts |
| **Max per Ticker** | 5% of portfolio | Prevents single-name blowups (UNH, AMT) |
| **Max per Sector** | 20% of portfolio | Limits sector-driven drawdowns |

---

## Reproducibility Checklist

```bash
# 1. Compute comprehensive performance report
python scripts/comprehensive_performance_report.py

# 2. Run with specific TP/SL
python scripts/comprehensive_performance_report.py --tp 50 --sl 20 --hold 90

# 3. Quick run (skip grid search and Monte Carlo)
python scripts/comprehensive_performance_report.py --skip-grid --skip-monte-carlo

# 4. PHP backtests (for comparison)
# php findstocks/api/backtest.php (via HTTP)
# curl 'https://findtorontoevents.ca/findstocks/api/backtest.php?algorithms=Blue%20Chip%20Growth&tp=50&sl=20&max_hold=90'

# 5. Daily quant pipeline
python scripts/run_daily.py
```
